{
	"name": "SQL script 10",
	"properties": {
		"content": {
			"query": "Select TABLE_B.Stichtag, BST_Nr,Zeus_Funktion_Bezeichnung, WERTART, BASISKENNZAHL_NAME\nfrom dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH TABLE_A\nCROSS JOIN (Select distinct(Stichtag) from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH) TABLE_B\nwhere TABLE_A.Stichtag = '2021-08-31' and Wertart='Soll'\n\n\nSELECT Stichtag, BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart\nFROM (Select BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart\nfrom dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Stichtag = '2021-08-31' and Wertart='Soll'\ngroup by BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart) AS a \nCROSS JOIN (Select distinct(Stichtag) from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH) AS b\n\nSelect count(*) \nfrom (\nSelect Table_B.Bezugsdatum,BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart  FROM\n(\nSelect BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart\nfrom dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Stichtag = '2021-08-31' and Wertart='Soll'\ngroup by BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart\n) Table_A\nCROSS JOIN (Select distinct(Bezugsdatum) from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH WHERE Stichtag Between dateadd(\"mm\",-11,'2021-08-31') AND '2021-08-31') TABLE_B\nEXCEPT\nSELECT Stichtag, BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Wertart='Soll'\n\n) Table_C\n\nEXCEPT\nSELECT BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Wertart='Soll'\n\n\nSelect count(*) \nfrom (\nSelect Table_B.Bezugsdatum,BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart  FROM\n(\nSelect BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart\nfrom dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Stichtag = '2021-08-31' and Wertart='Soll'\ngroup by BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart\n) Table_A\nCROSS JOIN (Select distinct(Bezugsdatum) from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH WHERE Stichtag = '2021-08-31' and Wertart='Soll') TABLE_B\nEXCEPT\nSELECT Bezugsdatum, BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Wertart from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Stichtag = '2021-08-31' and Wertart='Soll'\n) Table_C\n\nSelect '2021-08-31' as Stichtag, STAMMKST, BST_Nr,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, 'Soll' as Wertart, Table_B.Bezugsdatum, 'Zeit [d]' as MENGENEINHEIT\n          , 0 as WERT, 31 as LADELAUF_ID, '2021-08-31' as FGUELTIG_VON, '2199-12-31' as FGUELTIG_BIS\n\n\nINSERT INTO dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH\n(Stichtag, STAMMKST, BST_NR, BST_NAME,ZEUS_FUNKTION_BEZEICHNUNG, BASISKENNZAHL_NAME, MENGENEINHEIT, WERTART, BEZUGSDATUM, WERT, LADELAUF_ID, FGUELTIG_VON, FGUELTIG_BIS)\nSelect '2021-08-31' as Stichtag, STAMMKST, BST_Nr, BST_NAME, Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Bezugsdatum, 'Zeit [d]' as MENGENEINHEIT\n, 'Soll' as Wertart, 0 as WERT, 31 as LADELAUF_ID, '2021-08-31' as FGUELTIG_VON, '2199-12-31' as FGUELTIG_BIS          \nFROM \n(\nSelect STAMMKST, BST_Nr, BST_NAME, Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Table_B.Bezugsdatum\nFROM\n(\nSelect STAMMKST, BST_Nr,BST_NAME,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME\nfrom dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Stichtag = '2021-08-31' and Wertart='Soll'\ngroup by STAMMKST, BST_Nr,BST_NAME,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME\n) Table_A\nCROSS JOIN (Select distinct(Bezugsdatum) as Bezugsdatum from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH WHERE Stichtag = '2021-08-31' and Wertart='Soll') TABLE_B\nEXCEPT\nSELECT STAMMKST, BST_Nr,BST_NAME,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Bezugsdatum  from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Stichtag = '2021-08-31' and Wertart='Soll'\n) Table_D\n\n\nINSERT INTO dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH\n(Stichtag, STAMMKST, BST_NR, BST_NAME,ZEUS_FUNKTION_BEZEICHNUNG, BASISKENNZAHL_NAME, MENGENEINHEIT, WERTART, BEZUGSDATUM, WERT, LADELAUF_ID)\nSelect '2021-08-31' as Stichtag, STAMMKST, BST_Nr, BST_NAME, Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, '2021-08-31' as Bezugsdatum, 'Zeit [d]' as MENGENEINHEIT\n, 'Soll' as Wertart, 0 as WERT, 31 as LADELAUF_ID        \nFROM \n(\nSelect STAMMKST, BST_Nr, BST_NAME, Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Table_B.Bezugsdatum\nFROM\n(\nSelect STAMMKST, BST_Nr,BST_NAME,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME\nfrom dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Stichtag = '2021-08-31' and Wertart='Soll'\ngroup by STAMMKST, BST_Nr,BST_NAME,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME\n) Table_A\nCROSS JOIN (Select distinct(Bezugsdatum) as Bezugsdatum from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH WHERE Stichtag = '2021-08-31' and Wertart='Soll') TABLE_B\nEXCEPT\nSELECT STAMMKST, BST_Nr,BST_NAME,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Bezugsdatum  from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Stichtag = '2021-08-31' and Wertart='Soll'\n) Table_D\n\n\n\nINSERT INTO dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH\n(Stichtag, STAMMKST, BST_NR, BST_NAME, Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, BEZUGSDATUM, WERT, LADELAUF_ID, MENGENEINHEIT, FGUELTIG_VON, FGUELTIG_BIS, Wertart  )\nSelect '2021-08-31' as Stichtag, STAMMKST, BST_Nr, BST_NAME, Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, BEZUGSDATUM, 0 as WERT, 31 as LADELAUF_ID, 'Zeit [d]' as MENGENEINHEIT, '2021-08-31' as FGUELTIG_VON, '2199-12-31' as FGUELTIG_BIS, 'Soll' as Wertart \nFROM \n(\nSelect STAMMKST, BST_Nr, BST_NAME, Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Table_B.Bezugsdatum\nFROM\n(\nSelect STAMMKST, BST_Nr,BST_NAME,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME\nfrom dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Stichtag = '2021-08-31' and Wertart='Soll'\ngroup by STAMMKST, BST_Nr,BST_NAME,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME\n) Table_A\nCROSS JOIN (Select distinct(Bezugsdatum) as Bezugsdatum from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH WHERE Stichtag = '2021-08-31' and Wertart='Soll') TABLE_B\nEXCEPT\nSELECT STAMMKST, BST_Nr,BST_NAME,Zeus_Funktion_Bezeichnung, BASISKENNZAHL_NAME, Bezugsdatum  from dbo.MART_PERSONALMENGENSTEUERUNG_URLAUBSANSPRUCH \nwhere Stichtag = '2021-08-31' and Wertart='Soll'\n) Table_D\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "sqlpool1",
				"poolName": "sqlpool1"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}